![Demonstration](asciinema/diffdash-demo.gif)

# DiffDash

![npm version](https://img.shields.io/npm/v/@johnowennixon/diffdash.svg)
![NPM License](https://img.shields.io/npm/l/@johnowennixon/diffdash)
![Downloads](https://img.shields.io/npm/dm/@johnowennixon/diffdash.svg)
[![Ask DeepWiki](https://deepwiki.com/badge.svg)](https://deepwiki.com/johnowennixon/diffdash)

A command-line tool to generate Git commit messages using AI.

## Features

* Generate Git commit messages in natural language prose
* Add a prefix or suffix to the summary line to support tickets from project management tools
* Add a metadata footer to the generated commit messages
* Support for 42 human languages including English, Chinese, and Hindi
* Select from a choice of LLM models
* Compare messages generated from all configured models
* Disable or auto-approve various stages
* Option to output just the commit message for use in scripts
* Configuration using standard API provider environment variables
* Uses the Vercel AI SDK (version 6)
* Uses structured JSON with compatible models
* Substantially written using AI coding (Claude Code, Roo Code, and Amp Code)

## Installation from npmjs.com

```bash
npm install -g @johnowennixon/diffdash
```

## LLM Models

Currently, for this application, the best LLM model is **gpt-4.1-mini** from OpenAI.
It is set as the default model.
I can only presume they have done a ton of training on diffs.
I have tested later GPT models but they don't seem to be as good.

## API Keys

DiffDash requires at least one API key for an LLM provider. These must be provided as environment variables.

```bash
# For OpenAI (strongly recommended)
export OPENAI_API_KEY=your-api-key

# For Anthropic
export ANTHROPIC_API_KEY=your-api-key

# For DeepSeek
export DEEPSEEK_API_KEY=your-api-key

# For Google Gemini
export GEMINI_API_KEY=your-api-key

# For OpenRouter (all other models)
export OPENROUTER_API_KEY=your-api-key
```

## Usage

```bash
# Basic usage (uses defaults)
diffdash

# Automatically stage all changes, but still prompt for commit and push
diffdash --auto-add

# Automatically stage and commit changes, but still prompt for push
diffdash --auto-add --auto-commit

# Fully automated workflow (stage, commit, and push without prompts)
diffdash --auto-add --auto-commit --auto-push

# Generate message for already staged changes only (won't stage any new changes)
diffdash --disable-add

# Skip displaying the status of staged files before commit
diffdash --disable-status

# Don't display the generated commit message
diffdash --disable-preview

# Generate message but don't commit (exit after displaying the message)
diffdash --disable-commit

# Generate message and commit, but don't push or prompt to push
diffdash --disable-push

# Skip git hooks when pushing
diffdash --no-verify

# Add a prefix to the commit message summary line
diffdash --add-prefix "[FIX]"

# Add a suffix to the commit message summary line
diffdash --add-suffix "(closes #DEV-1234)"

# Generate commit message in a different language
diffdash --language af  # Afrikaans

# Display commit messages generated by all models
diffdash --llm-compare

# Specify the LLM model by name
diffdash --llm-model claude-3.5-haiku

# Just output the commit message for use in scripts
diffdash --just-output

# Debug prompts
diffdash --debug-llm-prompts
```

## Command Line Arguments

All command-line arguments are optional.

| Argument | Description |
| -------- | ----------- |
| `--help` | show a help message and exit |
| `--version` | show program version information and exit |
| `--auto-add` | automatically stage all changes without confirmation |
| `--auto-commit` | automatically commit changes without confirmation |
| `--auto-push` | automatically push changes after commit without confirmation |
| `--disable-add` | disable adding unstaged changes - exit if no changes staged |
| `--disable-status` | disable listing the staged files before generating a message |
| `--disable-preview` | disable previewing the generated message |
| `--disable-commit` | disable committing changes - exit after generating the message |
| `--disable-push` | disable pushing changes - exit after making the commit |
| `--add-prefix PREFIX` | add a prefix to the commit message summary line |
| `--add-suffix SUFFIX` | add a suffix to the commit message summary line |
| `--language CODE` | choose the language for commit messages (defaults to 'en' for English) |
| `--llm-list` | display a list of available Large Language Models and exit |
| `--llm-compare` | compare the generated messages from all models - but do not commit |
| `--llm-model MODEL` | choose the LLM model by name (the default is normally best) |
| `--llm-excludes MODELS` | models to exclude from comparison (comma separated) |
| `--no-secret-check` | bypass checking for secrets in diffs |
| `--no-verify` | bypass git hooks when committing or pushing to Git |
| `--force` | apply force when pushing to Git |
| `--just-output` | just output the commit message for use in scripts |
| `--silent` | suppress all normal output - errors and aborts still display |
| `--debug-llm-prompts` | show prompts sent to the LLM |
| `--debug-llm-inputs` | show inputs object sent to the LLM |
| `--debug-llm-outputs` | show outputs object received from the LLM |

## Files containing secrets

Files containing secrets should not be in Git. But if they are, you can add an entry to a `.gitattributes` file with value `-diff` to prevent them being viewable by a Git diff. This will prevent DiffDash from sending any contents to the LLM. For example:

```text
# This is file .gitattributes

.env  -diff
```

There is a rudimentary check for secrets in diffs before submitting to the LLM. If any are found, there is an interactive option to ignore. If you want to bypass this check, you can use the `--no-secret-check` flag.

## Development

You will need to install [bun](https://bun.com/docs/pm/cli/install).

To install on your laptop:

```bash
# Clone the repository
git clone https://github.com/johnowennixon/diffdash.git
cd diffdash

# Install dependencies
bun install

# Build the project
bun run build

# Make binaries executable
npm link
```

To rebuild after editing:

```bash
# Lint the code
bun run lint

# Fix formatting issues (if required)
bun run fix

# Build the project
bun run build
```

## License

0BSD
